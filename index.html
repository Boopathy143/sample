<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Sample Control</title>

<style>
body{font-family:Arial;background:#f3f4f6;margin:0;padding:15px}
input,select{width:100%;padding:8px;margin:6px 0}
button{padding:8px 12px;border:none;background:#2563eb;color:white}
.card{background:white;padding:12px;border-radius:8px;margin-bottom:15px}
</style>
</head>

<body>

<div class="card">
<h3>Add Sample</h3>

<input id="rack" placeholder="Rack">
<input id="lot" placeholder="Lot">
<input id="brand" placeholder="Brand">
<input id="pm" placeholder="PM Code">
<input id="sku" placeholder="SKU">
<input id="bottles" placeholder="Bottles">
<input type="date" id="date">

<button onclick="add()">Submit</button>
</div>

<div class="card">
<h3>Data</h3>
<div id="list"></div>
</div>

<script>

const API_URL="https://script.google.com/macros/s/AKfycbyjmNvPfuXx_nSlq04_4v-hucm6IA5bS4rZdOo8HWCicIPLD0yg7-U39OEgWfmg1t73fw/exec";

async function load(){
  const res = await fetch(API_URL);
  const data = await res.json();

  const list=document.getElementById("list");
  list.innerHTML="";

  data.forEach(r=>{
    list.innerHTML+=`
      <div>
        ${r[2]} | Rack ${r[1]}
        <button onclick="del('${r[0]}')" style="background:red">Delete</button>
      </div>
    `;
  });
}

async function add(){

  const body={
    action:"add",
    rack:document.getElementById("rack").value,
    lot:document.getElementById("lot").value,
    brand:document.getElementById("brand").value,
    pm:document.getElementById("pm").value,
    sku:document.getElementById("sku").value,
    bottles:document.getElementById("bottles").value,
    date:document.getElementById("date").value
  };

  const res=await fetch(API_URL,{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify(body)
  });

  const result=await res.json();

  if(result.status==="duplicate"){
    alert("Duplicate Entry");
    return;
  }

  load();
}

async function del(id){
  await fetch(API_URL,{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({action:"delete",id})
  });

  load();
}

load();

</script>
</body>
</html>
